/**
 * Copyright 2020 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
window.DynamicImportRegistry=window.DynamicImportRegistry||{},window.DynamicImportRegistry.requestAvailability=()=>(window.DynamicImportRegistry.instance||(window.DynamicImportRegistry.instance=document.createElement("dynamic-import-registry"),document.body.appendChild(window.DynamicImportRegistry.instance)),window.DynamicImportRegistry.instance);class t extends HTMLElement{static get tag(){return"dynamic-import-registry"}constructor(t=!1){super(),this.list={},this.__loaded={},this.basePath=new URL("./../../",import.meta.url).href,window.WCAutoloadBasePath?this.basePath=window.WCAutoloadBasePath:window.WCGlobalBasePath&&(this.basePath=window.WCGlobalBasePath)}connectedCallback(){window.addEventListener("dynamic-import-registry--register",this.registerDefinitionEvent.bind(this))}disconnectedCallback(){window.removeEventListener("dynamic-import-registry--register",this.registerDefinitionEvent.bind(this))}register(t){t.tag&&t.path?this.list[t.tag]||(this.list[t.tag]=t.path):console.warn("DynamicImportRegistry: registration requires tag and path be set")}registerDefinitionEvent(t){t.detail.tag&&t.detail.path&&this.register(t.detail)}async loadDefinition(t){if(t=t.toLowerCase(),!window.customElements.get(t)&&this.list[t]&&!this.__loaded[t]){this.__loaded[t]=!0;try{return await import(`${this.basePath}${this.list[t]}`).then((e=>{this.dispatchEvent(new CustomEvent("dynamic-import-registry-loaded",{detail:{tag:t,path:this.list[t],module:e}}))}))}catch(e){console.warn(`${this.basePath}${this.list[t]}`),console.warn(e),this.dispatchEvent(new CustomEvent("dynamic-import-registry-failure",{detail:{tag:t,path:this.list[t],module:null}}))}}}}window.customElements.define(t.tag,t),
/**
 * Copyright 2020 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 *
 */
window.WCAutoload=window.WCAutoload||{},window.WCAutoloadRegistry=window.WCAutoloadRegistry||{},window.WCAutoload.requestAvailability=()=>(window.WCAutoload.instance||(window.WCAutoload.instance=document.createElement("wc-autoload"),document.body.appendChild(window.WCAutoload.instance)),window.WCAutoload.instance);const e=async(t,e,i)=>{for(let o=0;o<i;o++)try{return await fetch(t,e)}catch(t){if(o+1===i)throw t}};window.WCAutoload.process=t=>new Promise(((t,i)=>{var o=window.WCAutoload.requestAvailability();o.loaded=!0;var a={};if(window.WCAutoloadRegistryFileProcessed){let e=document;o.target&&(e=o.target,o.processNewElement(e)),e.querySelectorAll("*").forEach((t=>{t.tagName&&!a[t.tagName]&&(o.processNewElement(t),a[t.tagName]=t.tagName)})),t("autoloader already processed")}else setTimeout((async()=>{if(window.WCAutoloadBasePath?o.registry.basePath=window.WCAutoloadBasePath:window.WCGlobalBasePath&&(o.registry.basePath=window.WCGlobalBasePath),window.WCAutoloadRegistryFile&&!window.WCAutoloadRegistryFileProcessed){"string"==typeof window.WCAutoloadRegistryFile&&(window.WCAutoloadRegistryFile=[window.WCAutoloadRegistryFile]);for(var i=0;i<window.WCAutoloadRegistryFile.length;i++)await e(window.WCAutoloadRegistryFile[i],{},3).then((function(t){return t.json()})).then((function(t){window.WCAutoloadRegistryFileProcessed=!0,window.WCAutoloadRegistry={...window.WCAutoloadRegistry,...t}}))}if(window.WCAutoloadRegistry)for(var i in window.WCAutoloadRegistry)o.registry.register({tag:i,path:window.WCAutoloadRegistry[i]});let s=document;o.target&&(s=o.target,o.processNewElement(s)),s.querySelectorAll("*").forEach((t=>{t.tagName&&!a[t.tagName]&&(o.processNewElement(t),a[t.tagName]=t.tagName)})),t("autoloader processed on the fly")}),0)})),window.addEventListener("load",window.WCAutoload.process),window.WCAutoload.postLoaded=t=>{setTimeout((()=>{let e=window.WCAutoload.requestAvailability();e.loaded&&document.querySelectorAll(t.detail.tag).length>0&&e.registry.loadDefinition(t.detail.tag)}),0)},window.addEventListener("dynamic-import-registry--new-registration",window.WCAutoload.postLoaded);class i extends HTMLElement{static get tag(){return"wc-registry"}constructor(){super(),this.loader=window.WCAutoload.requestAvailability()}connectedCallback(){setTimeout((()=>{if(this.children.length>0&&"TEMPLATE"==this.children[0].tagName)try{let e=JSON.parse(this.children[0].content.textContent);for(var t in e)this.loader.registry.register({tag:t,path:e[t]})}catch(t){console.warn(t)}}),0)}}customElements.define(i.tag,i);class o extends HTMLElement{static get tag(){return"wc-autoload"}constructor(){super(),this.loaded=!1,this.registry=window.DynamicImportRegistry.requestAvailability(),this.options={childList:!0,subtree:!0}}connectedCallback(){this._mutationObserver=new MutationObserver((t=>{t.forEach((t=>{t.addedNodes.forEach((t=>{this.processNewElement(t)}))}))})),window.WCAutoloadOptions&&(this.options=window.WCAutoloadOptions),setTimeout((()=>{window.WCAutoloadTarget?this.target=window.WCAutoloadTarget:this.target=document.body,this._mutationObserver.observe(this.target,this.options)}),0)}disconnectedCallback(){this._mutationObserver.disconnect()}processNewElement(t){t.tagName&&t.tagName.includes("-")&&"DYNAMIC-IMPORT-REGISTRY"!=t.tagName&&"WC-REGISTRY"!=t.tagName&&"WC-AUTOLOAD"!=t.tagName&&this.registry.loadDefinition(t.tagName)}}window.customElements.define(o.tag,o);export{o as WcAutoload};
